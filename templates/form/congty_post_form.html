{% extends 'main.html' %}
{% block content %}
<div class="container mt-4">
  <h2>üßæ Th√™m m·ªõi c√¥ng ty</h2>

  <form id="congTyForm">
    <div class="mb-3">
      <label for="tenCongTy" class="form-label">T√™n c√¥ng ty</label>
      <input type="text" class="form-control" id="tenCongTy" name="tenCongTy" required>
    </div>

    <div class="mb-3">
      <label for="nganh" class="form-label">Ng√†nh ngh·ªÅ</label>
      <input type="text" class="form-control" id="nganh" name="nganh">
    </div>

    <div class="mb-3">
      <label for="maChungKhoan" class="form-label">M√£ ch·ª©ng kho√°n</label>
      <input type="text" class="form-control" id="maChungKhoan" name="maChungKhoan" required>
    </div>

    <button type="submit" class="btn btn-primary">G·ª≠i d·ªØ li·ªáu</button>
  </form>

  <div id="result" class="mt-3"></div>
</div>

<script>
  document.getElementById("congTyForm").addEventListener("submit", async function (e) {
    e.preventDefault(); // NgƒÉn reload trang

    const formData = {
      tenCongTy: document.getElementById("tenCongTy").value,
      nganh: document.getElementById("nganh").value,
      maChungKhoan: document.getElementById("maChungKhoan").value,
    };

    const response = await fetch("/api/post_congty_data/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCookie("csrftoken"), // B·∫£o m·∫≠t CSRF
      },
      body: JSON.stringify(formData),
    });

    const data = await response.json();
    document.getElementById("result").innerHTML =
      `<div class="alert alert-${response.ok ? 'success' : 'danger'}">${data.message}</div>`;
  });


</script>
{% endblock %}
